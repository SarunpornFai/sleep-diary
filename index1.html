<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏° Sleep Diary</title>
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: auto; padding: 1em; }
    label { display: block; margin-top: 1em; }
    input, select { width: 100%; padding: 0.5em; margin-top: 0.3em; }
    button { margin-top: 1.5em; padding: 0.7em 1.5em; font-size: 1em; }
    .success, .error { margin-top: 1em; }
  </style>
</head>
<body>
  <h1>‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏° Sleep Diary üõè</h1>
  <form id="sleepForm">
    <label>1. ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏ô‡∏≤‡∏°‡πÅ‡∏ù‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
      <input type="text" id="name" required />
    </label>

    <label>2. ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
      <input type="date" id="date" required />
    </label>

    <label>3. ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏ô‡∏≠‡∏ô
      <input type="time" id="bedtime" required />
    </label>

    <label>4. ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏≤‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡πÉ‡∏î‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏´‡∏•‡∏±‡∏ö (‡∏ô‡∏≤‡∏ó‡∏µ)
      <input type="number" id="sleepLatency" min="0" required />
    </label>

    <label>5. ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏∑‡πà‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏î‡∏∂‡∏Å
      <select id="nightAwakenings" required>
        <option value="0">0</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3+">3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ</option>
      </select>
    </label>

    <label>6. ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡∏ï‡∏∑‡πà‡∏ô
      <input type="time" id="wakeTime" required />
    </label>

    <label>7. ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (1 = ‡πÅ‡∏¢‡πà‡∏°‡∏≤‡∏Å, 5 = ‡∏î‡∏µ‡∏°‡∏≤‡∏Å)
      <select id="sleepQuality" required>
        <option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option>
      </select>
    </label>

    <label>8. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡πà‡∏ß‡∏á‡∏´‡∏•‡∏±‡∏á‡∏ï‡∏∑‡πà‡∏ô (1 = ‡πÑ‡∏°‡πà‡∏á‡πà‡∏ß‡∏á, 5 = ‡∏á‡πà‡∏ß‡∏á‡∏°‡∏≤‡∏Å)
      <select id="morningSleepiness" required>
        <option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option>
      </select>
    </label>

    <label>9. ‡πÉ‡∏ä‡πâ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≠‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?
      <select id="phoneUse" required>
        <option value="‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡∏¢">‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡∏¢</option>
        <option value="<15 ‡∏ô‡∏≤‡∏ó‡∏µ">‡πÉ‡∏ä‡πâ &lt; 15 ‡∏ô‡∏≤‡∏ó‡∏µ</option>
        <option value="15‚Äì30 ‡∏ô‡∏≤‡∏ó‡∏µ">‡πÉ‡∏ä‡πâ 15‚Äì30 ‡∏ô‡∏≤‡∏ó‡∏µ</option>
        <option value=">30 ‡∏ô‡∏≤‡∏ó‡∏µ">‡πÉ‡∏ä‡πâ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 30 ‡∏ô‡∏≤‡∏ó‡∏µ</option>
      </select>
    </label>

    <label>10. ‡∏î‡∏∑‡πà‡∏°‡∏Ñ‡∏≤‡πÄ‡∏ü‡∏≠‡∏µ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?
      <select id="caffeineIntake" required>
        <option value="‡πÑ‡∏°‡πà‡∏î‡∏∑‡πà‡∏°‡πÄ‡∏•‡∏¢">‡πÑ‡∏°‡πà‡∏î‡∏∑‡πà‡∏°‡πÄ‡∏•‡∏¢</option>
        <option value="‡∏î‡∏∑‡πà‡∏°">‡∏î‡∏∑‡πà‡∏°</option>
      </select>
    </label>

    <label>11. ‡∏ô‡∏≠‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?
      <select id="nap" required>
        <option value="‡πÑ‡∏°‡πà‡∏ô‡∏≠‡∏ô">‡πÑ‡∏°‡πà‡∏ô‡∏≠‡∏ô</option>
        <option value="‡∏á‡∏µ‡∏ö‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 30 ‡∏ô‡∏≤‡∏ó‡∏µ">‡∏á‡∏µ‡∏ö‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 30 ‡∏ô‡∏≤‡∏ó‡∏µ</option>
        <option value="‡∏á‡∏µ‡∏ö‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 30 ‡∏ô‡∏≤‡∏ó‡∏µ">‡∏á‡∏µ‡∏ö‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 30 ‡∏ô‡∏≤‡∏ó‡∏µ</option>
      </select>
    </label>

    <button type="submit">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
  </form>

  <div class="success" id="successMsg" style="color:green; display:none;">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏±‡∏ö!</div>
  <div class="error" id="errorMsg" style="color:red; display:none;"></div>

  <script>
    const form = document.getElementById('sleepForm');
    const successMsg = document.getElementById('successMsg');
    const errorMsg = document.getElementById('errorMsg');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      successMsg.style.display = 'none';
      errorMsg.style.display = 'none';

      const data = {
        name: document.getElementById('name').value,
        date: document.getElementById('date').value,
        bedtime: document.getElementById('bedtime').value,
        sleepLatency: document.getElementById('sleepLatency').value,
        nightAwakenings: document.getElementById('nightAwakenings').value,
        wakeTime: document.getElementById('wakeTime').value,
        sleepQuality: document.getElementById('sleepQuality').value,
        morningSleepiness: document.getElementById('morningSleepiness').value,
        phoneUse: document.getElementById('phoneUse').value,
        caffeineIntake: document.getElementById('caffeineIntake').value,
        nap: document.getElementById('nap').value
      };

      try {
        const response = await fetch('https://script.google.com/macros/s/AKfycbxwMx82q7WGeeZRJ7mjhb3MNhlvaZ32_Dq0QRB3kjdSIYZdUBJJBIiUnquvp_HBkIWL/exec', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        const result = await response.json();
        if (result.status === 'success') {
          successMsg.style.display = 'block';
          form.reset();
        } else {
          throw new Error(result.message || 'Error unknown');
        }
      } catch (error) {
        errorMsg.textContent = '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message;
        errorMsg.style.display = 'block';
      }
    });
  </script>
</body>
</html>
